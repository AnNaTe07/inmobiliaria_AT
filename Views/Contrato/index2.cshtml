@{
    ViewData["Title"] = "Index";
}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="container mt-4">
        <h1>Contratos</h1>
        
        <form method="get" action="@Url.Action("Index")">
            <div class="row mb-3">
                <!-- Filtro por tipo (Propietario, Inmueble, Fecha) -->
                <div class="col-md-3">
                    <label for="tipoFiltro" class="form-label">Filtrar por:</label>
                    <select id="tipoFiltro" class="form-select" onchange="filtrar()">
                        <option value="0">Seleccionar</option>
                        <option value="Propietario">Propietario</option>
                        <option value="Propiedad">Inmueble</option>
                        <option value="Fecha">Fecha</option>
                    </select>
                </div>

                <!-- Filtro por propietario -->
                <div id="filtroPropietario" class="col-md-3" style="display:none;">
                    <label for="propietarioId" class="form-label">Seleccionar Propietario:</label>
                    <select name="propietarioId" class="form-select" asp-items="ViewBag.Propietarios">
                        <option value="">Seleccionar Propietario</option>
                    </select>
                </div>

                <!-- Filtro por inmueble -->
                <div id="filtroPropiedad" class="col-md-3" style="display:none;">
                    <label for="inmuebleId" class="form-label">Seleccionar Inmueble:</label>
                    <select name="inmuebleId" class="form-select" asp-items="ViewBag.Inmuebles">
                        <option value="">Seleccionar Inmueble</option>
                    </select>
                </div>

                <!-- Filtro por fecha (Fecha Desde y Fecha Hasta) -->
                <div id="filtroFecha" class="col-md-6 row" style="display:none;">
                    <!-- Fecha Desde -->
                    <div class="col-md-6">
                        <label for="fechaDesde" class="form-label">Fecha Desde:</label>
                        <input type="date" name="fechaDesde" class="form-control" />
                    </div>

                    <!-- Fecha Hasta -->
                    <div class="col-md-6">
                        <label for="fechaHasta" class="form-label">Fecha Hasta:</label>
                        <input type="date" name="fechaHasta" class="form-control" />
                    </div>
                </div>

                <!-- BotÃ³n de filtro -->
                <div class="col-md-2 d-flex align-items-end">
                    <button type="submit" class="btn btn-primary">Filtrar</button>
                </div>
            </div>
        </form>

        <!-- Tabla de resultados -->
        <table class="table table-striped mt-4">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Propietario</th>
                    <th>Inmueble</th>
                    <th>Fecha Inicio</th>
                    <th>Fecha Fin</th>
                    <th>Monto</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var contrato in Model)
                {
                    <tr>
                        <td>@contrato.Id</td>
                        <td>@contrato.Prop.NombreCompleto</td>
                        <td>@contrato.Inmu.Direccion</td>
                        <td>@contrato.FechaInicio.ToShortDateString()</td>
                        <td>@contrato.FechaFin.ToShortDateString()</td>
                        <td>@contrato.Monto</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <script>
        function filtrar() {
            var tipoFiltro = document.getElementById('tipoFiltro').value;
            document.getElementById('filtroPropietario').style.display = tipoFiltro === 'Propietario' ? 'block' : 'none';
            document.getElementById('filtroPropiedad').style.display = tipoFiltro === 'Propiedad' ? 'block' : 'none';
            document.getElementById('filtroFecha').style.display = tipoFiltro === 'Fecha' ? 'block' : 'none';
        }
    </script>
</body>
</html>
